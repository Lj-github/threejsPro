THREE.OrbitControls=function(e,t){this.object=e;this.domElement=t!==undefined?t:document;this.enabled=true;this.target=new THREE.Vector3;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.enableDamping=false;this.dampingFactor=.25;this.enableZoom=true;this.zoomSpeed=1;this.enableRotate=true;this.rotateSpeed=1;this.enablePan=true;this.panSpeed=1;this.panningMode=THREE.ScreenSpacePanning;this.keyPanSpeed=7;this.autoRotate=false;this.autoRotateSpeed=2;this.enableKeys=true;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;this.getPolarAngle=function(){return d.phi};this.getAzimuthalAngle=function(){return d.theta};this.saveState=function(){s.target0.copy(s.target);s.position0.copy(s.object.position);s.zoom0=s.object.zoom};this.reset=function(){s.target.copy(s.target0);s.object.position.copy(s.position0);s.object.zoom=s.zoom0;s.object.updateProjectionMatrix();s.dispatchEvent(c);s.update();u=l.NONE};this.update=function(){var n=new THREE.Vector3;var a=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0));var o=a.clone().inverse();var r=new THREE.Vector3;var i=new THREE.Quaternion;return function e(){var t=s.object.position;n.copy(t).sub(s.target);n.applyQuaternion(a);d.setFromVector3(n);if(s.autoRotate&&u===l.NONE){w(O())}d.theta+=p.theta;d.phi+=p.phi;d.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,d.theta));d.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,d.phi));d.makeSafe();d.radius*=E;d.radius=Math.max(s.minDistance,Math.min(s.maxDistance,d.radius));s.target.add(h);n.setFromSpherical(d);n.applyQuaternion(o);t.copy(s.target).add(n);s.object.lookAt(s.target);if(s.enableDamping===true){p.theta*=1-s.dampingFactor;p.phi*=1-s.dampingFactor;h.multiplyScalar(1-s.dampingFactor)}else{p.set(0,0,0);h.set(0,0,0)}E=1;if(f||r.distanceToSquared(s.object.position)>m||8*(1-i.dot(s.object.quaternion))>m){s.dispatchEvent(c);r.copy(s.object.position);i.copy(s.object.quaternion);f=false;return true}return false}}();this.dispose=function(){s.domElement.removeEventListener("contextmenu",ne,false);s.domElement.removeEventListener("mousedown",G,false);s.domElement.removeEventListener("wheel",Q,false);s.domElement.removeEventListener("touchstart",$,false);s.domElement.removeEventListener("touchend",te,false);s.domElement.removeEventListener("touchmove",ee,false);document.removeEventListener("mousemove",W,false);document.removeEventListener("mouseup",q,false);window.removeEventListener("keydown",J,false)};var s=this;var c={type:"change"};var n={type:"start"};var a={type:"end"};var l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5};var u=l.NONE;var m=1e-6;var d=new THREE.Spherical;var p=new THREE.Spherical;var E=1;var h=new THREE.Vector3;var f=false;var o=new THREE.Vector2;var r=new THREE.Vector2;var i=new THREE.Vector2;var b=new THREE.Vector2;var v=new THREE.Vector2;var g=new THREE.Vector2;var T=new THREE.Vector2;var R=new THREE.Vector2;var y=new THREE.Vector2;function O(){return 2*Math.PI/60/60*s.autoRotateSpeed}function H(){return Math.pow(.95,s.zoomSpeed)}function w(e){p.theta-=e}function P(e){p.phi-=e}var j=function(){var a=new THREE.Vector3;return function e(t,n){a.setFromMatrixColumn(n,0);a.multiplyScalar(-t);h.add(a)}}();var C=function(){var a=new THREE.Vector3;return function e(t,n){switch(s.panningMode){case THREE.ScreenSpacePanning:a.setFromMatrixColumn(n,1);break;case THREE.HorizontalPanning:a.setFromMatrixColumn(n,0);a.crossVectors(s.object.up,a);break}a.multiplyScalar(t);h.add(a)}}();var M=function(){var i=new THREE.Vector3;return function e(t,n){var a=s.domElement===document?s.domElement.body:s.domElement;if(s.object.isPerspectiveCamera){var o=s.object.position;i.copy(o).sub(s.target);var r=i.length();r*=Math.tan(s.object.fov/2*Math.PI/180);j(2*t*r/a.clientHeight,s.object.matrix);C(2*n*r/a.clientHeight,s.object.matrix)}else if(s.object.isOrthographicCamera){j(t*(s.object.right-s.object.left)/s.object.zoom/a.clientWidth,s.object.matrix);C(n*(s.object.top-s.object.bottom)/s.object.zoom/a.clientHeight,s.object.matrix)}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.");s.enablePan=false}}}();function S(e){if(s.object.isPerspectiveCamera){E/=e}else if(s.object.isOrthographicCamera){s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e));s.object.updateProjectionMatrix();f=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");s.enableZoom=false}}function k(e){if(s.object.isPerspectiveCamera){E*=e}else if(s.object.isOrthographicCamera){s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e));s.object.updateProjectionMatrix();f=true}else{console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.");s.enableZoom=false}}function L(e){o.set(e.clientX,e.clientY)}function N(e){T.set(e.clientX,e.clientY)}function A(e){b.set(e.clientX,e.clientY)}function x(e){r.set(e.clientX,e.clientY);i.subVectors(r,o).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;w(2*Math.PI*i.x/t.clientWidth);P(2*Math.PI*i.y/t.clientHeight);o.copy(r);s.update()}function D(e){R.set(e.clientX,e.clientY);y.subVectors(R,T);if(y.y>0){S(H())}else if(y.y<0){k(H())}T.copy(R);s.update()}function U(e){v.set(e.clientX,e.clientY);g.subVectors(v,b).multiplyScalar(s.panSpeed);M(g.x,g.y);b.copy(v);s.update()}function V(e){}function z(e){if(e.deltaY<0){k(H())}else if(e.deltaY>0){S(H())}s.update()}function Z(e){switch(e.keyCode){case s.keys.UP:M(0,s.keyPanSpeed);s.update();break;case s.keys.BOTTOM:M(0,-s.keyPanSpeed);s.update();break;case s.keys.LEFT:M(s.keyPanSpeed,0);s.update();break;case s.keys.RIGHT:M(-s.keyPanSpeed,0);s.update();break}}function Y(e){o.set(e.touches[0].pageX,e.touches[0].pageY)}function F(e){var t=e.touches[0].pageX-e.touches[1].pageX;var n=e.touches[0].pageY-e.touches[1].pageY;var a=Math.sqrt(t*t+n*n);T.set(0,a)}function I(e){b.set(e.touches[0].pageX,e.touches[0].pageY)}function X(e){r.set(e.touches[0].pageX,e.touches[0].pageY);i.subVectors(r,o).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;w(2*Math.PI*i.x/t.clientWidth);P(2*Math.PI*i.y/t.clientHeight);o.copy(r);s.update()}function K(e){var t=e.touches[0].pageX-e.touches[1].pageX;var n=e.touches[0].pageY-e.touches[1].pageY;var a=Math.sqrt(t*t+n*n);R.set(0,a);y.subVectors(R,T);if(y.y>0){k(H())}else if(y.y<0){S(H())}T.copy(R);s.update()}function _(e){v.set(e.touches[0].pageX,e.touches[0].pageY);g.subVectors(v,b).multiplyScalar(s.panSpeed);M(g.x,g.y);b.copy(v);s.update()}function B(e){}function G(e){if(s.enabled===false)return;e.preventDefault();switch(e.button){case s.mouseButtons.ORBIT:if(s.enableRotate===false)return;L(e);u=l.ROTATE;break;case s.mouseButtons.ZOOM:if(s.enableZoom===false)return;N(e);u=l.DOLLY;break;case s.mouseButtons.PAN:if(s.enablePan===false)return;A(e);u=l.PAN;break}if(u!==l.NONE){document.addEventListener("mousemove",W,false);document.addEventListener("mouseup",q,false);s.dispatchEvent(n)}}function W(e){if(s.enabled===false)return;e.preventDefault();switch(u){case l.ROTATE:if(s.enableRotate===false)return;x(e);break;case l.DOLLY:if(s.enableZoom===false)return;D(e);break;case l.PAN:if(s.enablePan===false)return;U(e);break}}function q(e){if(s.enabled===false)return;V(e);document.removeEventListener("mousemove",W,false);document.removeEventListener("mouseup",q,false);s.dispatchEvent(a);u=l.NONE}function Q(e){if(s.enabled===false||s.enableZoom===false||u!==l.NONE&&u!==l.ROTATE)return;e.preventDefault();e.stopPropagation();s.dispatchEvent(n);z(e);s.dispatchEvent(a)}function J(e){if(s.enabled===false||s.enableKeys===false||s.enablePan===false)return;Z(e)}function $(e){if(s.enabled===false)return;switch(e.touches.length){case 1:if(s.enableRotate===false)return;Y(e);u=l.TOUCH_ROTATE;break;case 2:if(s.enableZoom===false)return;F(e);u=l.TOUCH_DOLLY;break;case 3:if(s.enablePan===false)return;I(e);u=l.TOUCH_PAN;break;default:u=l.NONE}if(u!==l.NONE){s.dispatchEvent(n)}}function ee(e){if(s.enabled===false)return;e.preventDefault();e.stopPropagation();switch(e.touches.length){case 1:if(s.enableRotate===false)return;if(u!==l.TOUCH_ROTATE)return;X(e);break;case 2:if(s.enableZoom===false)return;if(u!==l.TOUCH_DOLLY)return;K(e);break;case 3:if(s.enablePan===false)return;if(u!==l.TOUCH_PAN)return;_(e);break;default:u=l.NONE}}function te(e){if(s.enabled===false)return;B(e);s.dispatchEvent(a);u=l.NONE}function ne(e){if(s.enabled===false)return;e.preventDefault()}s.domElement.addEventListener("contextmenu",ne,false);s.domElement.addEventListener("mousedown",G,false);s.domElement.addEventListener("wheel",Q,false);s.domElement.addEventListener("touchstart",$,false);s.domElement.addEventListener("touchend",te,false);s.domElement.addEventListener("touchmove",ee,false);window.addEventListener("keydown",J,false);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){console.warn("THREE.OrbitControls: .center has been renamed to .target");return this.target}},noZoom:{get:function(){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");return!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.");this.enableZoom=!e}},noRotate:{get:function(){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");return!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.");this.enableRotate=!e}},noPan:{get:function(){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");return!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.");this.enablePan=!e}},noKeys:{get:function(){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");return!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.");this.enableKeys=!e}},staticMoving:{get:function(){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");return!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.");this.enableDamping=!e}},dynamicDampingFactor:{get:function(){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");return this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.");this.dampingFactor=e}}});THREE.ScreenSpacePanning=0;THREE.HorizontalPanning=1;