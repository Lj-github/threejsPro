
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style type="text/css">
        *{
            margin:0;
            padding:0;
        }
        .img{
            animation:rotatez 7s;
            animation-timing-function:linear;
            animation-iteration-count:infinite;
        }
        @keyframes rotatez{
            0%{transform:rotateZ(0deg);}
            100%{transform:rotateZ(360deg);}
        }
        table td{
            border:1px solid #fff;
            text-align:center;
            font-size:30px;
            color:#fff;
        }
    </style>
    <title>自己做特效</title>
</head>
<body style="background-color:#fff;">
<script type="text/javascript" src="index.js">
</script>
<canvas id="canvas" style="border:0px solid #f00">
</canvas>
<div id='crt' style="width:100%; height:150px; border:0px solid #fff; background-color:#099; text-align:center;">

    <table cellspacing="0" style="width:100%;  height:100%; border:1px solid #fff;">
        <td style="width:25%;">
            <table id="msclist" class="msclist" style="width:100%; height:100%; background-color:#000;">

            </table>
        </td>
        <td style="width:50%;">
            <div onClick="last()" style="width:30%; cursor:pointer; line-height:130px; background-color:#63F; margin-left:3%; height:100%; float:left;">
                上一曲

            </div>
            <div onClick="run()" style="width:30%; cursor:pointer; background-color:#63F; margin-left:2%; height:100%; float:left;">
                <img id="img" src="img/friend.jpg" style=" margin-top:10px; height:120px; width:auto; border-radius:100%;" />

            </div>
            <div onClick="next()" style="width:30%; cursor:pointer; line-height:130px; background-color:#63F; margin-left:2%; height:100%; float:left;">
                下一曲
            </div>
        </td>
        <td style="width:25%;">
            <form oninput="cgcolor()">
                <table style="width:100%; height:100%; ">
                    <tr>
                        <td style="cursor:pointer;  background-color:#09C;" onClick="canvascg(1)">球状</td>
                        <td style="cursor:pointer; background-color:#09C;" onClick="canvascg(2)">柱形</td>
                        <td style="cursor:pointer; background-color:#09C;" onClick="canvascg(3)">线条</td>
                    </tr>
                    <!--<tr>

                     <td id="td1" style="cursor:pointer; font-size:18px; background-color:#09C;">开始<br /><input type="color" id='startc' /></td>

                     <td style="cursor:pointer; font-size:18px; background-color:#09C;">中点<br /><input type="color" id='contentc' /></td>
                     <td style="cursor:pointer; font-size:18px; background-color:#09C;">末端<br /><input type="color" id='endc' /></td>

                    </tr>-->
                </table>
            </form>
        </td>
    </table>

</div>
<audio id="audio"  style=" ">
</audio>


<button onclick="startRecording(this);">record</button>
<button onclick="stopRecording(this);" disabled>stop</button>


<ul id="recordingslist"></ul>

<h2>Log</h2>
<pre id="log"></pre>


<script>
    function __log(e, data) {
        log.innerHTML += "\n" + e + " " + (data || '');
    }

    var audio_context;
    var recorder;

    function startUserMedia(stream) {
        var input = audio_context.createMediaStreamSource(stream);
        __log('Media stream created.');

        // Uncomment if you want the audio to feedback directly
        //input.connect(audio_context.destination);
        //__log('Input connected to audio context destination.');

        recorder = new Recorder(input);
        __log('Recorder initialised.');
    }

    function startRecording(button) {
        recorder && recorder.record();
        button.disabled = true;
        button.nextElementSibling.disabled = false;
        __log('Recording...');
    }

    function stopRecording(button) {
        recorder && recorder.stop();
        button.disabled = true;
        button.previousElementSibling.disabled = false;
        __log('Stopped recording.');

        // create WAV download link using audio data blob
        createDownloadLink();

        recorder.clear();
    }

    function createDownloadLink() {
        recorder && recorder.exportWAV(function(blob) {
            var url = URL.createObjectURL(blob);
            var li = document.createElement('li');
            var au = document.createElement('audio');
            var hf = document.createElement('a');

            au.controls = true;
            au.src = url;

            document.getElementById('audio').src=url;
            run();
            cgcss();


            hf.href = url;
            hf.download = new Date().toISOString() + '.wav';
            hf.innerHTML = hf.download;
            li.appendChild(au);
            li.appendChild(hf);
            recordingslist.appendChild(li);
        });
    }


        try {
            // webkit shim
           // window.AudioContext = window.AudioContext || window.webkitAudioContext;
            navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia;
            window.URL = window.URL || window.webkitURL;

            audio_context = new AudioContext;
            __log('Audio context set up.');
            __log('navigator.getUserMedia ' + (navigator.getUserMedia ? 'available.' : 'not present!'));
        } catch (e) {
            alert('No web audio support in this browser!');
        }

        navigator.getUserMedia({audio: true}, startUserMedia, function(e) {
            __log('No live audio input: ' + e);
        });


</script>
<script src="der.js"></script>
</body>
</html>